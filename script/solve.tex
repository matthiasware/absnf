\section{Solve}
ABS-Normal Form:
\begin{flalign*}
	\begin{pmatrix}
		\Delta z \\
		\Delta y
	\end{pmatrix}
	= 
	\begin{pmatrix}
		a \\
		b
	\end{pmatrix}
	+
	\begin{pmatrix}
		Z & L \\
		J & Y 
	\end{pmatrix}
	\times
	\begin{pmatrix}
		\Delta x \\
		|\Delta z|
	\end{pmatrix}
\end{flalign*}

The last function, that had to be implemented was a solver for PL function in abs-normal form. Given:
\begin{flalign*}
	a,b,Z,L,J,Y,m,n,\Delta y
\end{flalign*}
We want to calculate:
\begin{flalign*}
	\Delta x, \Delta z
\end{flalign*}

\subsection{Deducing a solution}
First and foremost, we assume:
\begin{flalign*}
	\Delta y = 0
\end{flalign*}
It this is not the case, we can replace $b$ with $b'$:
\begin{flalign*}
	b' = b - \Delta y
\end{flalign*}
Now we can shift the equation system:
\begin{flalign*}
	\Delta y &= b + J \Delta x + Y |\Delta z| \\
	0 &= b + J \Delta x + Y |\Delta z| \\
	- b - Y |\Delta z| &= J \Delta x \\
	b + Y |\Delta z| &= J \Delta x (-1) \\
	J^{-1}(b + Y |\Delta z|) &= - \Delta x \\
	\Delta x = - J^{-1}(b + Y |\Delta z|)
\end{flalign*}

\begin{flalign*}
	\Delta z &= a + Z \Delta x + L |\Delta z| \\
	&= a + Z \Big( - J^{-1}(b + Y |\Delta z|) \Big) +  L |\Delta z| \\
	&= a + Z \Big( -J^{-1}b - J^{-1}Y|\Delta z| \Big) +  L |\Delta z| \\
	&= a - ZJ^{-1}b - Z J^{-1}Y|\Delta z| +  L |\Delta z| \\
	&= a - ZJ^{-1}b - (Z J^{-1}Y - L)|\Delta z|
\end{flalign*}
\begin{flalign*}
\Delta z &= a - ZJ^{-1}b - (Z J^{-1}Y - L)|\Delta z| \\
		 &= c + S|\Delta z| \\
c		 &= a - ZJ^{-1}b \\
S		 &= (L - Z J^{-1}Y)
\end{flalign*}

\subsection{Implementation}
\begin{flalign*}
	c &= a - ZJ^{-1}b \\
	S &= (L - Z J^{-1}Y)
\end{flalign*}
Need the inverse of $J$
\begin{itemize}
	\item Calculate cublas LU
	\item Cusolve QR
	\item LU -> Inverse
\end{itemize}
\begin{flalign*}
	c = a - Z* solve(J*X = b) \\
	S = L - Z* solve(J*X = Y) \\
\end{flalign*}
